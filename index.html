<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1280, initial-scale=1.0">
    <title>HishoAI Enhanced - ÂÆåÂÖ®Áâà</title>
    
    <!-- Êó¢Â≠ò„Éá„Çπ„ÇØ„Éà„ÉÉ„ÉóÂ∞ÇÁî®„Çπ„Çø„Ç§„É´„Ç∑„Éº„ÉàÔºàÈ†ÜÂ∫èÈáçË¶ÅÔºö„Éô„Éº„Çπ‚ÜíÊ©üËÉΩ‚ÜíÂ∞ÇÁî®Ôºâ -->
    <link rel="stylesheet" href="desktop-base.css">
    <link rel="stylesheet" href="desktop-chat.css">
    <link rel="stylesheet" href="desktop-features.css">
    <link rel="stylesheet" href="office.css">
    <link rel="stylesheet" href="translation.css">
    <link rel="stylesheet" href="correction.css">
    <link rel="stylesheet" href="transcript.css">
    
    <!-- ‚òÖÊñ∞Ê©üËÉΩÔºöË≥áÊñôË™øÊüªAIÂ∞ÇÁî®„Çπ„Çø„Ç§„É´„Ç∑„Éº„Éà -->
    <link rel="stylesheet" href="summary.css">
</head>

<body>
    <div class="app-container">
        <!-- „Çµ„Ç§„Éâ„Éê„ÉºÔºàÊó¢Â≠òÊ©üËÉΩÂÆåÂÖ®‰øùÊåÅÔºâ -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">ü§ñ</div>
                    <div>
                        <div class="logo-text">HishoAI</div>
                        <div class="logo-subtitle">Enhanced ÂÆåÂÖ®Áâà</div>
                    </div>
                </div>
            </div>
            
            <nav class="nav-section">
                <div class="nav-item active" data-tab="home">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">„Éõ„Éº„É†</span>
                </div>
                <div class="nav-item" data-tab="chat">
                    <span class="nav-icon">üí¨</span>
                    <span class="nav-text">„ÉÅ„É£„ÉÉ„Éà</span>
                </div>
                <div class="nav-item" data-tab="office">
                    <span class="nav-icon">üíº</span>
                    <span class="nav-text">OfficeÊîØÊè¥</span>
                </div>
                <div class="nav-item" data-tab="transcript">
                    <span class="nav-icon">üéµ</span>
                    <span class="nav-text">Èü≥Â£∞ÊñáÂ≠óËµ∑„Åì„Åó</span>
                </div>
                <div class="nav-item" data-tab="correction">
                    <span class="nav-icon">‚úèÔ∏è</span>
                    <span class="nav-text">Ê†°Ê≠£AI</span>
                </div>
                <div class="nav-item" data-tab="translate">
                    <span class="nav-icon">üåç</span>
                    <span class="nav-text">ÁøªË®≥</span>
                </div>
                <!-- ‚òÖÊó¢Â≠ò„ÅÆË¶ÅÁ¥Ñ„ÇíË≥áÊñôË™øÊüªAI„Å´ÁΩÆ„ÅçÊèõ„Åà -->
                <div class="nav-item" data-tab="summary">
                    <span class="nav-icon">üîç</span>
                    <span class="nav-text">Ë≥áÊñôË™øÊüªAI</span>
                </div>
                
                <div class="nav-divider"></div>
            </nav>
            
            <div class="api-status-section">
                <div class="api-status disconnected" id="apiSettingsBtn" onclick="showApiSettings()">
                    <div id="apiKeyStatus">‚ùå APIÊú™Ë®≠ÂÆö</div>
                    <span>‚öôÔ∏è</span>
                </div>
            </div>
        </aside>
        
        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑÔºàÊó¢Â≠òÊ©üËÉΩÂÆåÂÖ®‰øùÊåÅÔºâ -->
        <main class="main-container">
            <!-- „Éà„ÉÉ„Éó„Éê„ÉºÔºàÊó¢Â≠òÊ©üËÉΩÂÆåÂÖ®‰øùÊåÅÔºâ -->
            <header class="topbar">
                <h1 class="page-title">„Éõ„Éº„É†</h1>
                <div class="topbar-actions">
                    <div id="topbarActions">
                        <!-- ÂãïÁöÑ„Å´Êõ¥Êñ∞„Åï„Çå„Çã -->
                    </div>
                </div>
            </header>
            
            <!-- „Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ÔºàÊó¢Â≠òÊ©üËÉΩÂÆåÂÖ®‰øùÊåÅÔºâ -->
            <div class="content-area">
                <div class="content-wrapper">
                    <!-- ‚òÖÊñ∞Ë¶èÔºö„É°„Ç§„É≥ÁîªÈù¢„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <section id="homeSection" class="content-section active">
                        <div class="home-container">
                            <!-- APIË®≠ÂÆö„Éú„Çø„É≥ -->
                            <div class="home-api-settings">
                                <button class="api-settings-btn" onclick="showApiSettings()">
                                    <span class="api-settings-icon">‚öôÔ∏è</span>
                                    <span class="api-settings-text">APIË®≠ÂÆö</span>
                                </button>
                            </div>
                            
                            <!-- „É°„Ç§„É≥„Çø„Ç§„Éà„É´ -->
                            <div class="home-header">
                                <h1 class="home-title">HishoAI Enhanced</h1>
                                <p class="home-subtitle">AI powered productivity suite</p>
                            </div>
                            
                            <!-- Ê©üËÉΩ„Ç´„Éº„Éâ„Ç∞„É™„ÉÉ„Éâ -->
                            <div class="feature-cards-grid">
                                <div class="feature-card" data-feature="chat">
                                    <div class="feature-card-icon">üí¨</div>
                                    <h3 class="feature-card-title">„ÉÅ„É£„ÉÉ„Éà</h3>
                                    <p class="feature-card-desc">AI„Å®„ÅÆÂØæË©±</p>
                                </div>
                                
                                <div class="feature-card" data-feature="office">
                                    <div class="feature-card-icon">üíº</div>
                                    <h3 class="feature-card-title">OfficeÊîØÊè¥</h3>
                                    <p class="feature-card-desc">Word„ÉªExcel„ÉªPowerPoint</p>
                                </div>
                                
                                <div class="feature-card" data-feature="transcript">
                                    <div class="feature-card-icon">üéµ</div>
                                    <h3 class="feature-card-title">Èü≥Â£∞ÊñáÂ≠óËµ∑„Åì„Åó</h3>
                                    <p class="feature-card-desc">Èü≥Â£∞„Çí„ÉÜ„Ç≠„Çπ„Éà„Å´Â§âÊèõ</p>
                                </div>
                                
                                <div class="feature-card" data-feature="correction">
                                    <div class="feature-card-icon">‚úèÔ∏è</div>
                                    <h3 class="feature-card-title">Ê†°Ê≠£AI</h3>
                                    <p class="feature-card-desc">„ÉÜ„Ç≠„Çπ„ÉàÊ†°Ê≠£„ÉªÊ∑ªÂâä</p>
                                </div>
                                
                                <div class="feature-card" data-feature="translate">
                                    <div class="feature-card-icon">üåç</div>
                                    <h3 class="feature-card-title">ÁøªË®≥</h3>
                                    <p class="feature-card-desc">Â§öË®ÄË™ûÁøªË®≥„Éª„É™„Ç¢„É´„Çø„Ç§„É†</p>
                                </div>
                                
                                <div class="feature-card" data-feature="summary">
                                    <div class="feature-card-icon">üîç</div>
                                    <h3 class="feature-card-title">Ë≥áÊñôË™øÊüªAI</h3>
                                    <p class="feature-card-desc">Ë§áÊï∞Ë≥áÊñô„ÅÆÂàÜÊûê„ÉªË¶ÅÁ¥Ñ</p>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Êó¢Â≠òÔºö„ÉÅ„É£„ÉÉ„Éà„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <section id="chatSection" class="content-section">
                        <div class="chat-interface">
                            <div class="chat-main">
                                <div class="chat-header">
                                    <div class="chat-header-info">
                                        <h2>AI„ÉÅ„É£„ÉÉ„Éà</h2>
                                        <p>„É¢„Éº„Éâ„ÇíÂàá„ÇäÊõø„Åà„Å¶ÊúÄÈÅ©„Å™ÂøúÁ≠î„Çπ„Çø„Ç§„É´„ÇíÈÅ∏Êäû</p>
                                    </div>
                                    <div class="chat-header-top">
                                        <div class="chat-mode-selector">
                                            <!-- „É¢„Éº„Éâ„Çø„Éñ„ÅØJavaScript„ÅßÂãïÁöÑ„Å´ÁîüÊàê -->
                                        </div>
                                        <div class="chat-header-actions">
                                            <button class="chat-header-btn" onclick="showChatStats()">
                                                üìä <span>Áµ±Ë®à</span>
                                            </button>
                                            <button class="chat-header-btn" onclick="clearChat()">
                                                üóëÔ∏è <span>„ÇØ„É™„Ç¢</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- „É¢„Éº„ÉâÊÉÖÂ†±„Ç´„Éº„Éâ -->
                                <div class="mode-info-card">
                                    <!-- ÂÜÖÂÆπ„ÅØJavaScript„ÅßÂãïÁöÑ„Å´Êõ¥Êñ∞ -->
                                </div>
                                
                                <!-- „É°„ÉÉ„Çª„Éº„Ç∏„Ç®„É™„Ç¢ -->
                                <div class="chat-messages" id="chatMessages">
                                    <div class="chat-welcome">
                                        <div class="welcome-icon">ü§ñ</div>
                                        <h3>HishoAI „Å∏„Çà„ÅÜ„Åì„ÅùÔºÅ</h3>
                                        <p>‰Ωï„Åß„ÇÇ„ÅäÊ∞óËªΩ„Å´„ÅîË≥™Âïè„Åè„Å†„Åï„ÅÑ„ÄÇ„É¢„Éº„Éâ„ÇíÂàá„ÇäÊõø„Åà„Çã„Åì„Å®„Åß„ÄÅÊúÄÈÅ©„Å™ÂøúÁ≠î„Çπ„Çø„Ç§„É´„ÇíÈÅ∏„Åπ„Åæ„Åô„ÄÇ</p>
                                        <p style="color: var(--primary); font-size: var(--text-sm); margin-top: 0.5rem;">üí° „Éí„É≥„Éà: Enter„Ç≠„Éº„ÅßÈÄÅ‰ø°„ÄÅShift+Enter„ÅßÊîπË°å</p>
                                    </div>
                                </div>
                                
                                <!-- „Çµ„É≥„Éó„É´„Çª„ÇØ„Ç∑„Éß„É≥ -->
                                <div class="chat-samples-section">
                                    <div class="samples-header">
                                        <div class="samples-title">üí° „Åì„Çì„Å™Ë≥™Âïè„ÇíË©¶„Åó„Å¶„Åø„Çà„ÅÜ</div>
                                    </div>
                                    <div class="chat-samples-grid">
                                        <!-- „Çµ„É≥„Éó„É´„Ç´„Éº„Éâ„ÅØJavaScript„ÅßÂãïÁöÑ„Å´ÁîüÊàê -->
                                    </div>
                                </div>
                                
                                <!-- ÂÖ•Âäõ„Ç®„É™„Ç¢ -->
                                <div class="chat-input-area">
                                    <div class="chat-input-wrapper">
                                        <textarea 
                                            id="chatInput" 
                                            class="chat-input" 
                                            placeholder="„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂÖ•Âäõ... (Enter„ÅßÈÄÅ‰ø°)"
                                            rows="1"
                                        ></textarea>
                                        <div class="chat-input-actions">
                                            <button class="input-action-btn send-btn" onclick="sendChatMessage()" id="sendBtn" title="ÈÄÅ‰ø° (Enter)">
                                                <span class="send-icon">üì§</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Êó¢Â≠òÔºöOfficeÊîØÊè¥„Çª„ÇØ„Ç∑„Éß„É≥Ôºà„Çµ„É≥„Éó„É´Ë°®Á§∫Âà∂Âæ°ÂâäÈô§ÁâàÔºâ -->
                    <section id="officeSection" class="content-section">
                        <div class="office-interface">
                            <div class="office-main">
                                <div class="office-header">
                                    <div class="office-header-info">
                                        <h2>OfficeÊîØÊè¥</h2>
                                        <p>Word„ÄÅExcel„ÄÅPowerPoint„ÅÆÊìç‰Ωú„ÇíAI„Åå„Çµ„Éù„Éº„Éà</p>
                                    </div>
                                    <div class="office-header-top">
                                        <div class="office-mode-selector" role="tablist" aria-label="Office„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÈÅ∏Êäû">
                                            <button class="office-tab active" role="tab" aria-selected="true" aria-controls="word-panel" data-office-mode="word">
                                                <span class="office-tab-icon">üìù</span>
                                                <span class="office-tab-name">Word</span>
                                            </button>
                                            <button class="office-tab" role="tab" aria-selected="false" aria-controls="excel-panel" data-office-mode="excel">
                                                <span class="office-tab-icon">üìä</span>
                                                <span class="office-tab-name">Excel</span>
                                            </button>
                                            <button class="office-tab" role="tab" aria-selected="false" aria-controls="powerpoint-panel" data-office-mode="powerpoint">
                                                <span class="office-tab-icon">üìë</span>
                                                <span class="office-tab-name">PowerPoint</span>
                                            </button>
                                        </div>
                                        <div class="office-header-actions">
                                            <button class="office-header-btn" onclick="clearOfficeChat()">
                                                üóëÔ∏è <span>„ÇØ„É™„Ç¢</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Office „É°„ÉÉ„Çª„Éº„Ç∏„Ç®„É™„Ç¢ -->
                                <div class="office-messages" id="officeMessages">
                                    <div class="office-welcome">
                                        <div class="welcome-icon">üíº</div>
                                        <h3>OfficeÊîØÊè¥„Å∏„Çà„ÅÜ„Åì„ÅùÔºÅ</h3>
                                        <p>‰∏äÈÉ®„ÅÆ„Çø„Éñ„ÅßWord„ÄÅExcel„ÄÅPowerPoint„ÇíÂàá„ÇäÊõø„Åà„Å¶„ÄÅÂêÑ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Å´ÁâπÂåñ„Åó„Åü„Çµ„Éù„Éº„Éà„ÇíÂèó„Åë„Çâ„Çå„Åæ„Åô„ÄÇ</p>
                                        <p style="color: var(--primary); font-size: 0.875rem; margin-top: 0.5rem;">
                                            ‚ö° „ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥„Åß140Âïè„ÅÆÂÆüÁî®ÁöÑ„Å™Ë≥™Âïè„ÇíÈÅ∏Êäû„Åß„Åç„Åæ„Åô
                                        </p>
                                    </div>
                                </div>

                                <!-- Office „Çø„Éñ„Éë„Éç„É´Ôºà„ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥Ê©üËÉΩ„ÅÆ„ÅøÔºâ -->
                                <div class="office-tab-panels">
                                    <!-- Word „Éë„Éç„É´ -->
                                    <div id="word-panel" class="office-panel active" role="tabpanel" aria-labelledby="word-tab">
                                        <div class="sample-toggle-section">
                                            <button class="show-quick-actions-btn" onclick="showOfficeQuickActions()">
                                                <span>‚ö°</span>
                                                <span>„ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥</span>
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Excel „Éë„Éç„É´ -->
                                    <div id="excel-panel" class="office-panel" role="tabpanel" aria-labelledby="excel-tab">
                                        <div class="sample-toggle-section">
                                            <button class="show-quick-actions-btn" onclick="showOfficeQuickActions()">
                                                <span>‚ö°</span>
                                                <span>„ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥</span>
                                            </button>
                                        </div>
                                    </div>

                                    <!-- PowerPoint „Éë„Éç„É´ -->
                                    <div id="powerpoint-panel" class="office-panel" role="tabpanel" aria-labelledby="powerpoint-tab">
                                        <div class="sample-toggle-section">
                                            <button class="show-quick-actions-btn" onclick="showOfficeQuickActions()">
                                                <span>‚ö°</span>
                                                <span>„ÇØ„Ç§„ÉÉ„ÇØ„Ç¢„ÇØ„Ç∑„Éß„É≥</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Ë≤º„Çä‰ªò„Åë„Ç®„É™„Ç¢ -->
                                <div class="office-paste-area-container">
                                    <div class="office-paste-area compact" id="officePasteArea">
                                        <div class="paste-icon">üì∑</div>
                                        <div class="paste-text">
                                            <strong>Ctrl+V „Åß„Çπ„ÇØ„É™„Éº„É≥„Ç∑„Éß„ÉÉ„Éà„ÇíË≤º„Çä‰ªò„Åë</strong>
                                            <p>OfficeÁîªÈù¢„ÅÆ„Çπ„ÇØ„É™„Éº„É≥„Ç∑„Éß„ÉÉ„Éà„ÇíË≤º„Çä‰ªò„Åë„Å¶„ÄÅÂÖ∑‰ΩìÁöÑ„Å™Êìç‰ΩúÊñπÊ≥ï„ÇíË≥™Âïè„Åß„Åç„Åæ„Åô</p>
                                        </div>
                                    </div>
                                    
                                    <div id="officeImagePreviewArea" class="office-image-preview-area" style="display: none;">
                                        <div class="preview-header">
                                            <h4>üì∏ Ë≤º„Çä‰ªò„Åë„Åï„Çå„ÅüÁîªÂÉè</h4>
                                            <button class="remove-image-btn" onclick="removeOfficePreviewImage()">üóëÔ∏è ÂâäÈô§</button>
                                        </div>
                                        <div class="preview-image-container">
                                            <img id="officePreviewImg" alt="„Éó„É¨„Éì„É•„ÉºÁîªÂÉè">
                                        </div>
                                    </div>
                                </div>

                                <!-- OfficeÂøúÁ≠î„É¢„Éº„ÉâÂàá„ÇäÊõø„Åà -->
                                <div class="office-response-modes">
                                    <button class="office-mode-btn active" data-response-mode="step" onclick="setOfficeResponseMode('step')">
                                        üìù ÊâãÈ†ÜË™¨Êòé
                                    </button>
                                    <button class="office-mode-btn" data-response-mode="simple" onclick="setOfficeResponseMode('simple')">
                                        ‚ö° „Åã„Çì„Åü„ÇìË™¨Êòé
                                    </button>
                                </div>

                                <!-- OfficeÂÖ•Âäõ„Ç®„É™„Ç¢ -->
                                <div class="office-input-area">
                                    <div class="office-input-wrapper">
                                        <textarea 
                                            id="officeInput" 
                                            class="office-input" 
                                            placeholder="Office„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Å´„Å§„ÅÑ„Å¶Ë≥™Âïè„Åó„Å¶„Åè„Å†„Åï„ÅÑ... (Enter„ÅßÈÄÅ‰ø°)"
                                            rows="1"
                                        ></textarea>
                                        <div class="office-input-actions">
                                            <button class="input-action-btn send-btn" onclick="sendOfficeMessage()" id="officeSendBtn" title="ÈÄÅ‰ø° (Enter)">
                                                <span class="send-icon">üì§</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Êó¢Â≠òÔºöÈü≥Â£∞ÊñáÂ≠óËµ∑„Åì„Åó„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <section id="transcriptSection" class="content-section">
                        <!-- JavaScript„ÅßÂãïÁöÑ„É¨„É≥„ÉÄ„É™„É≥„Ç∞„Åï„Çå„Çã„Ç≥„É≥„ÉÜ„Éä -->
                        <div class="transcript-container">
                            <!-- IntegratedTranscriptUI.render() „Å´„Çà„ÇäÂãïÁöÑÁîüÊàê„Åï„Çå„ÇãÂÜÖÂÆπ -->
                        </div>
                    </section>

                    <!-- Êó¢Â≠òÔºöÊ†°Ê≠£AI„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <section id="correctionSection" class="content-section">
                        <div class="correction-container feature-container">
                            <div class="feature-header">
                                <div class="feature-title">
                                    <div class="feature-icon-large">‚úèÔ∏è</div>
                                    <div>ÈÄ≤ÂåñÁâàÊ†°Ê≠£AIÊ©üËÉΩ</div>
                                </div>
                                <p class="feature-description">„ÉÜ„Ç≠„Çπ„Éà„ÇíÈÅ∏Êäû„Åó„Å¶Ê†°Ê≠£ÊñπÈáù„ÇíÊåáÂÆö„ÄÇÊ†°Ê≠£ÂâçÂæå„ÇíÂ∑¶Âè≥ÊØîËºÉ„Åó„ÄÅÂ§âÊõ¥ÁÆáÊâÄ„ÇíËµ§Â≠óÂº∑Ë™øË°®Á§∫„Åó„Åæ„Åô„ÄÇ</p>
                            </div>
                            
                            <div class="form-group">
                                <label for="correctionInput" class="form-label">Ê†°Ê≠£„Åó„Åü„ÅÑ„ÉÜ„Ç≠„Çπ„Éà:</label>
                                <textarea 
                                    id="correctionInput" 
                                    class="form-textarea" 
                                    placeholder="Ê†°Ê≠£„Åó„Åü„ÅÑÊñáÁ´†„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ...&#10;&#10;üí° ‰Ωø„ÅÑÊñπ:&#10;1. „ÉÜ„Ç≠„Çπ„Éà„ÇíÂÖ•Âäõ&#10;2. Ê†°Ê≠£„Åó„Åü„ÅÑÈÉ®ÂàÜ„ÇíÈÅ∏ÊäûÔºàÂÖ®Êñá„ÅÆÂ†¥Âêà„ÅØÈÅ∏Êäû‰∏çË¶ÅÔºâ&#10;3. Ê†°Ê≠£ÊñπÈáù„ÇíÂÖ•Âäõ&#10;4. Ê†°Ê≠£„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ"
                                    rows="8"
                                ></textarea>
                            </div>
                            
                            <!-- Ê†°Ê≠£„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ„ÅØJavaScript„ÅßÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Çã -->
                        </div>
                    </section>

                    <!-- Êó¢Â≠òÔºöÁøªË®≥„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <section id="translateSection" class="content-section">
                        <div class="translate-container feature-container">
                            <div class="feature-header">
                                <div class="feature-title">
                                    <div class="feature-icon-large">üåç</div>
                                    <div>AIÁøªË®≥Ê©üËÉΩ</div>
                                </div>
                                <p class="feature-description">„ÉÜ„Ç≠„Çπ„Éà„ÇíÁû¨ÊôÇ„Å´Â§öË®ÄË™ûÁøªË®≥„Åó„Åæ„Åô„ÄÇ„Éì„Ç∏„Éç„Çπ„ÄÅÂ≠¶Áøí„ÄÅÊóÖË°å„Å´ÊúÄÈÅ©„Åß„Åô„ÄÇ</p>
                            </div>
                            
                            <!-- „É™„Ç¢„É´„Çø„Ç§„É†ÁøªË®≥„ÅÆË™¨Êòé -->
                            <div class="realtime-help">
                                <h4>‚ö° „Çπ„Éº„Éë„Éº„É™„Ç¢„É´„Çø„Ç§„É†ÁøªË®≥</h4>
                                <ul>
                                    <li><strong>Âè≥„ÇØ„É™„ÉÉ„ÇØ</strong>„Åæ„Åü„ÅØ<strong>„ÉÄ„Éñ„É´„ÇØ„É™„ÉÉ„ÇØ</strong>„ÅßÁøªË®≥„Éú„Çø„É≥„ÇíÊäº„Åô„Å®„É™„Ç¢„É´„Çø„Ç§„É†ÁøªË®≥„É¢„Éº„Éâ„Å´„Å™„Çä„Åæ„Åô</li>
                                    <li>ÂÖ•Âäõ‰∏≠„Å´Ëá™Âãï„ÅßÁøªË®≥„ÅåÊõ¥Êñ∞„Åï„Çå„Åæ„Åô</li>
                                    <li>‚èπÔ∏è„Éú„Çø„É≥„Åæ„Åü„ÅØÂÜçÂ∫¶Âè≥„ÇØ„É™„ÉÉ„ÇØ„ÅßÂÅúÊ≠¢„Åß„Åç„Åæ„Åô</li>
                                </ul>
                            </div>
                            
                            <div class="form-group">
                                <label for="translateInput" class="form-label">ÁøªË®≥„Åó„Åü„ÅÑ„ÉÜ„Ç≠„Çπ„Éà:</label>
                                <textarea 
                                    id="translateInput" 
                                    class="form-textarea" 
                                    placeholder="ÁøªË®≥„Åó„Åü„ÅÑ„ÉÜ„Ç≠„Çπ„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ..."
                                    rows="6"
                                ></textarea>
                            </div>
                            
                            <div class="button-group" id="translateButtons">
                                <button class="btn btn-primary translate-btn" data-lang="en" id="translateToEn" title="„ÇØ„É™„ÉÉ„ÇØÔºöÈÄöÂ∏∏ÁøªË®≥ | Âè≥„ÇØ„É™„ÉÉ„ÇØ/„ÉÄ„Éñ„É´„ÇØ„É™„ÉÉ„ÇØÔºö„É™„Ç¢„É´„Çø„Ç§„É†ÁøªË®≥">
                                    üá∫üá∏ Ëã±Ë™û„Å´ÁøªË®≥
                                </button>
                                <button class="btn btn-primary translate-btn" data-lang="zh" id="translateToZh" title="„ÇØ„É™„ÉÉ„ÇØÔºöÈÄöÂ∏∏ÁøªË®≥ | Âè≥„ÇØ„É™„ÉÉ„ÇØ/„ÉÄ„Éñ„É´„ÇØ„É™„ÉÉ„ÇØÔºö„É™„Ç¢„É´„Çø„Ç§„É†ÁøªË®≥">
                                    üá®üá≥ ‰∏≠ÂõΩË™û„Å´ÁøªË®≥
                                </button>
                                <button class="btn btn-primary translate-btn" data-lang="ko" id="translateToKo" title="„ÇØ„É™„ÉÉ„ÇØÔºöÈÄöÂ∏∏ÁøªË®≥ | Âè≥„ÇØ„É™„ÉÉ„ÇØ/„ÉÄ„Éñ„É´„ÇØ„É™„ÉÉ„ÇØÔºö„É™„Ç¢„É´„Çø„Ç§„É†ÁøªË®≥">
                                    üá∞üá∑ ÈüìÂõΩË™û„Å´ÁøªË®≥
                                </button>
                                <button class="btn btn-primary translate-btn" data-lang="ja" id="translateToJa" title="„ÇØ„É™„ÉÉ„ÇØÔºöÈÄöÂ∏∏ÁøªË®≥ | Âè≥„ÇØ„É™„ÉÉ„ÇØ/„ÉÄ„Éñ„É´„ÇØ„É™„ÉÉ„ÇØÔºö„É™„Ç¢„É´„Çø„Ç§„É†ÁøªË®≥">
                                    üáØüáµ Êó•Êú¨Ë™û„Å´ÁøªË®≥
                                </button>
                            </div>
                        </div>
                    </section>

                    <!-- ‚òÖÊñ∞Ê©üËÉΩÔºöË≥áÊñôË™øÊüªAI„Çª„ÇØ„Ç∑„Éß„É≥ÔºàÊó¢Â≠ò„ÅÆË¶ÅÁ¥Ñ„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÁΩÆ„ÅçÊèõ„ÅàÔºâ -->
                    <section id="summarySection" class="content-section">
                        <!-- 
                        ‚òÖÈáçË¶ÅÔºö„Åì„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥„ÅÆÂÜÖÂÆπ„ÅØsummary.js„ÅÆenterSummaryMode()„Åß
                        ÂãïÁöÑ„Å´3„Ç´„É©„É†„É¨„Ç§„Ç¢„Ç¶„Éà„Å´ÁΩÆ„ÅçÊèõ„Åà„Çâ„Çå„Åæ„Åô 
                        -->
                        <div class="summary-placeholder">
                            <div class="feature-container">
                                <div class="feature-header">
                                    <div class="feature-title">
                                        <div class="feature-icon-large">üîç</div>
                                        <div>Ë≥áÊñôË™øÊüªAIÊ©üËÉΩ</div>
                                    </div>
                                    <p class="feature-description">Ë§áÊï∞„ÅÆË≥áÊñôÔºàPDF, DOCX, TXT, MDÔºâ„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åó„Å¶„ÄÅAI„ÅåÊ®™Êñ≠ÁöÑ„Å´ÂàÜÊûê„ÉªË¶ÅÁ¥Ñ„Åó„Åæ„Åô„ÄÇ</p>
                                </div>
                                
                                <div style="text-align: center; padding: 3rem;">
                                    <div style="font-size: 4rem; margin-bottom: 1rem;">üöÄ</div>
                                    <h3>Ë≥áÊñôË™øÊüªAI„ÇíËµ∑Âãï‰∏≠...</h3>
                                    <p>Â∑¶ÂÅ¥„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Åã„Çâ„ÄåË≥áÊñôË™øÊüªAI„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                                    <button class="btn btn-primary" onclick="enterSummaryMode()" style="margin-top: 1rem;">
                                        üîç Ë≥áÊñôË™øÊüªAI„ÇíÈñãÂßã
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </main>
    </div>

    <!-- Êó¢Â≠òÔºöAPIË®≠ÂÆö„É¢„Éº„ÉÄ„É´ -->
    <div class="modal-overlay" id="apiModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üîë API„Ç≠„ÉºË®≠ÂÆö</h2>
                <button class="modal-close" onclick="closeApiModal()">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="api-intro">
                    <h3>üöÄ HishoAI Enhanced „Å∏„Çà„ÅÜ„Åì„ÅùÔºÅ</h3>
                    <p>ÊúÄÈ´ò„ÅÆAI‰ΩìÈ®ì„ÅÆ„Åü„ÇÅ„ÄÅOpenAI API„Ç≠„Éº„ÇíË®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                </div>
                
                <div class="api-warning card" style="background: #fef3c7; border: 1px solid #f59e0b; padding: 1rem; margin: 1rem 0;">
                    <div style="display: flex; gap: 1rem;">
                        <div class="warning-icon">üîí</div>
                        <div class="warning-content">
                            <h4 style="margin: 0 0 0.5rem 0;">„Éó„É©„Ç§„Éê„Ç∑„Éº‰øùË≠∑</h4>
                            <p style="margin: 0; font-size: var(--text-sm);">API„Ç≠„Éº„ÅØ„Åä‰Ωø„ÅÑ„ÅÆ„Éñ„É©„Ç¶„Ç∂„Å´„ÅÆ„Åø‰øùÂ≠ò„Åï„Çå„ÄÅÂ§ñÈÉ®„Å´ÈÄÅ‰ø°„Åï„Çå„Çã„Åì„Å®„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
                        </div>
                    </div>
                </div>
                
                <form class="api-form" onsubmit="return false;">
                    <div class="form-group">
                        <label for="openaiApiKey" class="form-label">OpenAI API„Ç≠„Éº</label>
                        <input 
                            type="password" 
                            id="openaiApiKey" 
                            class="form-input" 
                            placeholder="sk-..." 
                            autocomplete="off"
                        >
                        <div class="form-help" style="font-size: var(--text-sm); color: var(--gray-600); margin-top: 0.5rem;">
                            OpenAI„Ç¢„Ç´„Ç¶„É≥„Éà„ÅÆ<a href="https://platform.openai.com/api-keys" target="_blank">API Keys</a>„Éö„Éº„Ç∏„ÅßÂèñÂæó„Åß„Åç„Åæ„Åô
                        </div>
                    </div>
                    
                    <div class="button-row" style="margin-top: 1rem;">
                        <button type="button" class="btn btn-secondary" onclick="testApiKey()" id="testBtn">
                            üîç Êé•Á∂ö„ÉÜ„Çπ„Éà
                        </button>
                    </div>
                    
                    <div id="apiStatus" class="api-status" style="display: none; margin-top: 1rem; padding: 1rem; border-radius: var(--radius-md);"></div>
                </form>
                
                <div class="offline-notice card" style="background: #e0e7ff; border: 1px solid #6366f1; padding: 1rem; margin-top: 1rem;">
                    <h4 style="margin: 0 0 0.5rem 0;">üì± „Ç™„Éï„É©„Ç§„É≥„É¢„Éº„Éâ„Å´„Å§„ÅÑ„Å¶</h4>
                    <p style="margin: 0; font-size: var(--text-sm);">API„Ç≠„Éº„Å™„Åó„Åß„ÇÇÂü∫Êú¨Ê©üËÉΩÔºà„Çµ„É≥„Éó„É´ÁøªË®≥„ÉªOfficeÊîØÊè¥„Å™„Å©Ôºâ„Çí„ÅäË©¶„Åó„ÅÑ„Åü„Å†„Åë„Åæ„Åô</p>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="skipApiSetup()">‚è≠Ô∏è Âæå„ÅßË®≠ÂÆö</button>
                <button class="btn btn-primary" onclick="saveApiKey()" id="saveBtn" disabled>‚úÖ ‰øùÂ≠ò„Åó„Å¶ÈñãÂßã</button>
            </div>
        </div>
    </div>

    <!-- Êó¢Â≠òJavaScriptË™≠„ÅøËæº„ÅøÔºàÈ†ÜÂ∫èÈáçË¶ÅÔºöË®≠ÂÆö‚Üí„Éá„Éº„Çø„Éô„Éº„Çπ‚Üí„Ç≥„Ç¢‚ÜíÊ©üËÉΩÔºâ -->
    <script src="config.js"></script>
    <!-- ‚òÖÈáçË¶ÅÔºöoffice-samples.js„Çíoffice.js„Çà„ÇäÂâç„Å´Ë™≠„ÅøËæº„ÇÄ -->
    <script src="office-samples.js"></script>
    <script src="core.js"></script>
    <script src="chat.js"></script>
    <script src="office.js"></script>
    <script src="transcript.js"></script>
    <script src="correction.js"></script>
    <script src="translation.js"></script>
    
    <!-- ‚òÖÊñ∞Ê©üËÉΩÔºöË≥áÊñôË™øÊüªAIÂ∞ÇÁî®JavaScript -->
    <script src="summary.js"></script>
    
    <!-- Êó¢Â≠òÔºöÂàùÊúüÂåñ„Çπ„ÇØ„É™„Éó„ÉàÔºà„Çµ„É≥„Éó„É´Ë°®Á§∫Âà∂Âæ°Èñ¢ÈÄ£„ÇíÂâäÈô§Ôºâ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ HishoAI Enhanced Desktop starting...');
            
            if (typeof window.DEFAULT_MODEL === 'undefined') {
                console.error('‚ùå Config not loaded properly');
                return;
            }
            
            // ‚òÖ„Éá„Éï„Ç©„É´„Éà„ÅßÂÖ®ÁîªÈù¢„Éõ„Éº„É†„É¢„Éº„Éâ„ÇíÊúâÂäπ
            document.body.classList.add('fullscreen-home');
            
            // Êó¢Â≠ò„Ç∑„Çπ„ÉÜ„É†„ÅÆÂàùÊúüÂåñ
            if (typeof initializeApp !== 'undefined') {
                initializeApp();
            }
            
            initializeDesktopUI();
            
            console.log('‚úÖ HishoAI Enhanced Desktop ÂàùÊúüÂåñÂÆå‰∫Ü');
            console.log('üîç Ë≥áÊñôË™øÊüªAIÊ©üËÉΩ„ÇÇÂà©Áî®ÂèØËÉΩ„Åß„Åô');
        });
        
        function initializeDesktopUI() {
            updateTopbarActions();
            setupSidebarNavigation();
        }
        
        // ‚òÖÊó¢Â≠ò„ÅÆswitchTabÈñ¢Êï∞„Å´Ë≥áÊñôË™øÊüªAIÁµÇ‰∫ÜÂá¶ÁêÜ„ÇíËøΩÂä†
        const originalSwitchTab = window.switchTab;
        window.switchTab = function(tabName) {
            // ‚òÖÂÖ®ÁîªÈù¢„É¢„Éº„Éâ„ÅÆÂà∂Âæ°
            if (tabName === 'home') {
                document.body.classList.add('fullscreen-home');
            } else {
                document.body.classList.remove('fullscreen-home');
            }
            
            // ‚òÖË≥áÊñôË™øÊüªAI„ÅåÈñã„ÅÑ„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØÁµÇ‰∫Ü
            if (tabName !== 'summary' && window.SummaryAI && window.SummaryAI.initialized) {
                const summarySection = document.getElementById('summarySection');
                if (summarySection && summarySection.querySelector('.summary-app-container')) {
                    window.SummaryAI.exitSummaryMode();
                }
            }
            
            // ÂÖ®„Å¶„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÈùûË°®Á§∫
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // ÊåáÂÆö„Åï„Çå„Åü„Çª„ÇØ„Ç∑„Éß„É≥„ÇíË°®Á§∫
            const targetSection = document.getElementById(tabName + 'Section');
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // Êó¢Â≠ò„ÅÆswitchTabÂá¶ÁêÜ„ÇíÁ∂öË°å
            if (originalSwitchTab) {
                originalSwitchTab(tabName);
            }
        };
        
        function setupSidebarNavigation() {
            document.querySelectorAll('.nav-item[data-tab]').forEach(item => {
                item.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    if (tabName) {
                        // ‚òÖ„Éõ„Éº„É†ÁîªÈù¢„ÅÆÂ†¥Âêà„ÅØÁâπÂà•Âá¶ÁêÜ
                        if (tabName === 'home') {
                            document.body.classList.add('fullscreen-home');
                            switchTab('home');
                            document.querySelectorAll('.nav-item').forEach(nav => {
                                nav.classList.remove('active');
                            });
                            this.classList.add('active');
                            
                            const pageTitle = document.querySelector('.page-title');
                            if (pageTitle) {
                                pageTitle.textContent = '„Éõ„Éº„É†';
                            }
                            return;
                        }
                        
                        // ‚òÖ‰ªñ„ÅÆ„Çø„Éñ„Å´ÁßªÂãïÊôÇ„ÅØÂÖ®ÁîªÈù¢„É¢„Éº„ÉâËß£Èô§
                        document.body.classList.remove('fullscreen-home');
                        
                        // ‚òÖË≥áÊñôË™øÊüªAI„ÅÆÂ†¥Âêà„ÅØÁâπÂà•Âá¶ÁêÜ
                        if (tabName === 'summary') {
                            enterSummaryMode();
                            return;
                        }
                        
                        // ‚òÖ‰ªñ„ÅÆ„Çø„Éñ„Å´Âàá„ÇäÊõø„Åà„ÇãÊôÇ„ÅØË≥áÊñôË™øÊüªAI„É¢„Éº„Éâ„ÇíÁµÇ‰∫Ü
                        if (window.SummaryAI && window.SummaryAI.initialized) {
                            // ÁèæÂú®Ë≥áÊñôË™øÊüªAI„ÅåË°®Á§∫‰∏≠„ÅÆÂ†¥Âêà„ÅØÁµÇ‰∫Ü
                            const summarySection = document.getElementById('summarySection');
                            if (summarySection && summarySection.querySelector('.summary-app-container')) {
                                window.SummaryAI.exitSummaryMode();
                            }
                        }
                        
                        // Êó¢Â≠ò„ÅÆ„Çø„ÉñÂàá„ÇäÊõø„ÅàÂá¶ÁêÜ
                        switchTab(tabName);
                        
                        document.querySelectorAll('.nav-item').forEach(nav => {
                            nav.classList.remove('active');
                        });
                        this.classList.add('active');
                        
                        const pageTitle = document.querySelector('.page-title');
                        if (pageTitle) {
                            const navText = this.querySelector('.nav-text').textContent;
                            pageTitle.textContent = navText;
                        }
                        
                        updateTopbarActions();
                    }
                });
            });
            
            // ‚òÖÊ©üËÉΩ„Ç´„Éº„Éâ„ÅÆ„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà
            document.querySelectorAll('.feature-card').forEach(card => {
                card.addEventListener('click', function() {
                    const feature = this.getAttribute('data-feature');
                    if (feature) {
                        // ‚òÖÂÖ®ÁîªÈù¢„É¢„Éº„ÉâËß£Èô§
                        document.body.classList.remove('fullscreen-home');
                        
                        // ÂØæÂøú„Åô„ÇãÊ©üËÉΩ„Å´ÁßªÂãï
                        if (feature === 'summary') {
                            enterSummaryMode();
                        } else {
                            switchTab(feature);
                        }
                        
                        // „Çµ„Ç§„Éâ„Éê„Éº„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„ÇÇÊõ¥Êñ∞
                        document.querySelectorAll('.nav-item').forEach(nav => {
                            nav.classList.remove('active');
                        });
                        
                        const targetNav = document.querySelector(`[data-tab="${feature}"]`);
                        if (targetNav) {
                            targetNav.classList.add('active');
                        }
                        
                        // „Éö„Éº„Ç∏„Çø„Ç§„Éà„É´Êõ¥Êñ∞
                        const pageTitle = document.querySelector('.page-title');
                        if (pageTitle) {
                            const cardTitle = this.querySelector('.feature-card-title').textContent;
                            pageTitle.textContent = cardTitle;
                        }
                        
                        updateTopbarActions();
                    }
                });
            });
        }
        
        // ‚òÖÊñ∞Ê©üËÉΩÔºöË¶ÅÁ¥Ñ„Çª„ÇØ„Ç∑„Éß„É≥„Å´Êàª„Çã„Éú„Çø„É≥Áî®„ÅÆÈñ¢Êï∞
        window.returnToSummaryPlaceholder = function() {
            const summarySection = document.getElementById('summarySection');
            if (summarySection) {
                summarySection.innerHTML = `
                    <div class="summary-placeholder">
                        <div class="feature-container">
                            <div class="feature-header">
                                <div class="feature-title">
                                    <div class="feature-icon-large">üîç</div>
                                    <div>Ë≥áÊñôË™øÊüªAIÊ©üËÉΩ</div>
                                </div>
                                <p class="feature-description">Ë§áÊï∞„ÅÆË≥áÊñôÔºàPDF, DOCX, TXT, MDÔºâ„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åó„Å¶„ÄÅAI„ÅåÊ®™Êñ≠ÁöÑ„Å´ÂàÜÊûê„ÉªË¶ÅÁ¥Ñ„Åó„Åæ„Åô„ÄÇ</p>
                            </div>
                            
                            <div style="text-align: center; padding: 3rem;">
                                <div style="font-size: 4rem; margin-bottom: 1rem;">üöÄ</div>
                                <h3>Ë≥áÊñôË™øÊüªAI„ÇíËµ∑Âãï‰∏≠...</h3>
                                <p>Â∑¶ÂÅ¥„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Åã„Çâ„ÄåË≥áÊñôË™øÊüªAI„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÈñãÂßã„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                                <button class="btn btn-primary" onclick="enterSummaryMode()" style="margin-top: 1rem;">
                                    üîç Ë≥áÊñôË™øÊüªAI„ÇíÈñãÂßã
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }
        };
    </script>
</body>
</html>
