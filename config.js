// ===================================================================
// HishoAI Enhanced - è²·ã„åˆ‡ã‚Šå®Œå…¨ç‰ˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæ—¢å­˜æ©Ÿèƒ½å®Œå…¨ä¿æŒãƒ»10000ãƒˆãƒ¼ã‚¯ãƒ³å¯¾å¿œç‰ˆï¼‰
// ===================================================================
// ğŸ”§ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯åˆå¿ƒè€…ãŒè§¦ã£ã¦OKãªè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ã™
// ğŸ”§ APIã‚­ãƒ¼ã‚„ãƒ¢ãƒ‡ãƒ«è¨­å®šã‚’å¤‰æ›´ã—ãŸã„å ´åˆã¯ã“ã“ã‚’ç·¨é›†ã—ã¦ãã ã•ã„
// ===================================================================

// ===== OpenAI APIè¨­å®š =====
// ğŸ¤– ä½¿ç”¨ã™ã‚‹AIãƒ¢ãƒ‡ãƒ«ã®è¨­å®šï¼ˆå°†æ¥ã®ãƒ¢ãƒ‡ãƒ«å¤‰æ›´ã¯ã“ã“1è¡Œã ã‘ã§OKï¼‰
window.DEFAULT_MODEL = 'gpt-4o';  // â† ãƒ¢ãƒ‡ãƒ«å¤‰æ›´ã¯ã“ã“ã ã‘ï¼

// ğŸ“ åˆ©ç”¨å¯èƒ½ãªãƒ¢ãƒ‡ãƒ«ä¸€è¦§ï¼ˆå‚è€ƒï¼‰
// - 'gpt-4o'          : æœ€æ–°ã®é«˜æ€§èƒ½ãƒ¢ãƒ‡ãƒ«ï¼ˆVisionå¯¾å¿œï¼‰
// - 'gpt-4'           : é«˜ç²¾åº¦ãƒ¢ãƒ‡ãƒ«
// - 'gpt-3.5-turbo'   : é«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«
// - 'gpt-4-turbo'     : ãƒãƒ©ãƒ³ã‚¹å‹ãƒ¢ãƒ‡ãƒ«

// ğŸ”‘ APIã‚­ãƒ¼ã®åˆæœŸåŒ–ï¼ˆå¾Œã§ApiKeyManagerãŒç®¡ç†ï¼‰
window.OPENAI_API_KEY = '';

// APIã‚­ãƒ¼ã®åˆæœŸèª­ã¿è¾¼ã¿ï¼ˆå®‰å…¨ã«å®Ÿè¡Œï¼‰
(function initializeApiKey() {
   try {
       const savedKey = localStorage.getItem('hishoai_openai_key');
       if (savedKey && savedKey.startsWith('sk-')) {
           window.OPENAI_API_KEY = savedKey;
           console.log('âœ… åˆæœŸAPIã‚­ãƒ¼èª­ã¿è¾¼ã¿æˆåŠŸ');
       } else if (savedKey) {
           console.warn('âš ï¸ ç„¡åŠ¹ãªAPIã‚­ãƒ¼å½¢å¼ã‚’æ¤œå‡ºã€å‰Šé™¤ã—ã¾ã™');
           localStorage.removeItem('hishoai_openai_key');
       }
   } catch (error) {
       console.warn('âš ï¸ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ã®APIã‚­ãƒ¼èª­ã¿è¾¼ã¿ã«å¤±æ•—:', error.message);
   }
})();

// ===== AIæ©Ÿèƒ½ã®è¨­å®šï¼ˆæ—¢å­˜æ©Ÿèƒ½ä¿æŒãƒ»ç¿»è¨³ã®ã¿å¼·åŒ–ï¼‰ =====
// ğŸŒ¡ï¸ AIå¿œç­”ã®å‰µé€ æ€§ãƒ¬ãƒ™ãƒ«ï¼ˆ0.0 = ä¿å®ˆçš„ã€1.0 = å‰µé€ çš„ï¼‰
window.AI_TEMPERATURE = {
   translation: 0.2,    // ç¿»è¨³ï¼šè¶…é«˜ç²¾åº¦é‡è¦–ï¼ˆ0.3â†’0.2 é•·æ–‡ä¸€è²«æ€§å¼·åŒ–ï¼‰
   correction: 0.2,     // æ ¡æ­£ï¼šå³å¯†æ€§é‡è¦–
   office: 0.3,         // Officeæ”¯æ´ï¼šå®Ÿç”¨æ€§é‡è¦–
   vision: 0.3,         // Visionè§£æï¼šæ­£ç¢ºæ€§é‡è¦–
   summary: 0.4,        // è¦ç´„ï¼šãƒãƒ©ãƒ³ã‚¹é‡è¦–
   transcript: 0.1,     // éŸ³å£°æ–‡å­—èµ·ã“ã—ï¼šè¶…æ­£ç¢ºæ€§é‡è¦–
   analysis: 0.2,       // ç”»åƒè§£æï¼šæ­£ç¢ºæ€§é‡è¦–
   general: 0.7         // ä¸€èˆ¬å¯¾è©±ï¼šå‰µé€ æ€§é‡è¦–
};

// ğŸ“Š AIå¿œç­”ã®æœ€å¤§æ–‡å­—æ•°åˆ¶é™ï¼ˆç¿»è¨³ã®ã¿10000ãƒˆãƒ¼ã‚¯ãƒ³ã«æ‹¡å¼µï¼‰
window.MAX_TOKENS = {
   translation: 10000,  // ç¿»è¨³ï¼šæ¥­ç•Œæœ€å¤§ç´šï¼ˆ1000â†’10000 é•·æ–‡å¯¾å¿œå¼·åŒ–ï¼‰
   correction: 1200,    // æ ¡æ­£
   office: 1500,        // Officeæ”¯æ´
   vision: 1500,        // Visionè§£æ
   summary: 800,        // è¦ç´„
   transcript: 2000,    // éŸ³å£°æ–‡å­—èµ·ã“ã—ï¼ˆé•·æ–‡å¯¾å¿œï¼‰
   analysis: 1800,      // ç”»åƒè§£æï¼ˆè©³ç´°åˆ†æå¯¾å¿œï¼‰
   general: 1000        // ä¸€èˆ¬
};

// ===== éŸ³å£°å‡¦ç†è¨­å®š =====
// ğŸ¤ Whisper APIç”¨è¨­å®š
window.AUDIO_SETTINGS = {
   // ã‚µãƒãƒ¼ãƒˆã™ã‚‹éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼
   supportedFormats: [
       'audio/mpeg',       // .mp3
       'audio/wav',        // .wav
       'audio/mp4',        // .m4a
       'audio/webm',       // .webm
       'audio/ogg',        // .ogg
       'audio/flac'        // .flac
   ],
   
   // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™ï¼ˆMBï¼‰
   maxFileSize: 25,     // OpenAI Whisper APIã®åˆ¶é™
   
   // å‡¦ç†è¨€èªè¨­å®š
   defaultLanguage: 'ja',  // æ—¥æœ¬èªã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
   
   // å‡ºåŠ›å½¢å¼è¨­å®š
   responseFormat: 'verbose_json',  // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ãè©³ç´°å‡ºåŠ›
   
   // AIæ¸©åº¦è¨­å®š
   temperature: 0.1     // éŸ³å£°èªè­˜ã®æ­£ç¢ºæ€§é‡è¦–
};

// ===== ç”»åƒè§£æè¨­å®š =====
// ğŸ–¼ï¸ Vision APIç”¨è¨­å®š
window.IMAGE_SETTINGS = {
   // ã‚µãƒãƒ¼ãƒˆã™ã‚‹ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼
   supportedFormats: [
       'image/jpeg',       // .jpg, .jpeg
       'image/png',        // .png
       'image/webp',       // .webp
       'image/gif'         // .gif
   ],
   
   // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™ï¼ˆMBï¼‰
   maxFileSize: 20,     // Vision APIã®æ¨å¥¨åˆ¶é™
   
   // ç”»åƒè§£æã®è©³ç´°ãƒ¬ãƒ™ãƒ«
   detail: 'high',      // 'low' | 'high' | 'auto'
   
   // è§£æãƒ¢ãƒ¼ãƒ‰è¨­å®š
   analysisMode: {
       error: 'ã‚¨ãƒ©ãƒ¼ç”»é¢ã®è§£æã¨è§£æ±ºç­–ææ¡ˆ',
       software: 'ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ç”»é¢ã®ä½¿ã„æ–¹èª¬æ˜',
       code: 'ã‚³ãƒ¼ãƒ‰ç”»é¢ã®ãƒã‚°æ¤œå‡ºã¨ä¿®æ­£ææ¡ˆ',
       ui: 'UI/UXæ”¹å–„ææ¡ˆ',
       office: 'Officeç”»é¢ã®æ“ä½œæ”¯æ´',
       general: 'ä¸€èˆ¬çš„ãªç”»é¢è§£æ'
   }
};

// ===== ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆè²¼ã‚Šä»˜ã‘è¨­å®š =====
// ğŸ“· Clipboard APIç”¨è¨­å®š
window.SCREENSHOT_SETTINGS = {
   // ã‚µãƒãƒ¼ãƒˆã™ã‚‹è²¼ã‚Šä»˜ã‘å½¢å¼
   supportedClipboardTypes: [
       'image/png',        // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ¨™æº–å½¢å¼
       'image/jpeg',       // JPEGç”»åƒ
       'image/webp',       // WebPç”»åƒ
       'image/gif'         // GIFç”»åƒ
   ],
   
   // è²¼ã‚Šä»˜ã‘ç”»åƒã®è‡ªå‹•ãƒªã‚µã‚¤ã‚ºè¨­å®š
   autoResize: {
       enabled: true,          // è‡ªå‹•ãƒªã‚µã‚¤ã‚ºã‚’æœ‰åŠ¹åŒ–
       maxWidth: 1920,         // æœ€å¤§å¹…ï¼ˆpxï¼‰
       maxHeight: 1080,        // æœ€å¤§é«˜ã•ï¼ˆpxï¼‰
       quality: 0.9           // JPEGå“è³ªï¼ˆ0.1-1.0ï¼‰
   },
   
   // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºè¨­å®š
   preview: {
       maxDisplayWidth: 600,   // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æœ€å¤§è¡¨ç¤ºå¹…
       maxDisplayHeight: 400,  // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æœ€å¤§è¡¨ç¤ºé«˜ã•
       showFileName: true,     // ãƒ•ã‚¡ã‚¤ãƒ«åè¡¨ç¤º
       showFileSize: true      // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºè¡¨ç¤º
   },
   
   // Vision APIé€£æºè¨­å®š
   visionIntegration: {
       enabled: true,              // Vision APIé€£æºã‚’æœ‰åŠ¹åŒ–
       defaultPrompt: 'ã“ã®ç”»åƒã«ã¤ã„ã¦è©³ã—ãåˆ†æã—ã¦ãã ã•ã„ã€‚',
       contextualPrompts: {
           office: 'ã“ã® Office ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç”»é¢ã«ã¤ã„ã¦ã€æ“ä½œæ–¹æ³•ã‚„è§£æ±ºç­–ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚',
           error: 'ã“ã®ã‚¨ãƒ©ãƒ¼ç”»é¢ã®å†…å®¹ã‚’åˆ†æã—ã€åŸå› ã¨è§£æ±ºç­–ã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚',
           code: 'ã“ã®ã‚³ãƒ¼ãƒ‰ç”»é¢ã‚’åˆ†æã—ã€å•é¡Œç‚¹ã‚„æ”¹å–„æ¡ˆã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚',
           ui: 'ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®æ”¹å–„ç‚¹ã‚’åˆ†æã—ã¦ãã ã•ã„ã€‚'
       }
   }
};

// ===== UIè¨­å®š =====
// ğŸ¨ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ãƒ¼ãƒè¨­å®š
window.UI_SETTINGS = {
   // é€šçŸ¥ã®è‡ªå‹•æ¶ˆå»æ™‚é–“ï¼ˆãƒŸãƒªç§’ï¼‰
   notificationDuration: 5000,
   
   // ãƒ—ãƒ­ã‚»ã‚·ãƒ³ã‚°è¡¨ç¤ºã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é€Ÿåº¦
   processingDelay: 1500,
   
   // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é€Ÿåº¦
   modalAnimationSpeed: 300,
   
   // ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ï¼ˆtrue = è©³ç´°ãƒ­ã‚°è¡¨ç¤ºï¼‰
   debugMode: true,
   
   // APIã‚­ãƒ¼ç®¡ç†ã®è¨­å®š
   apiKeyValidation: {
       minLength: 40,          // æœ€å°æ–‡å­—æ•°
       maxLength: 60,          // æœ€å¤§æ–‡å­—æ•°
       prefix: 'sk-',          // å¿…é ˆãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹
       testTimeout: 10000      // ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆãƒŸãƒªç§’ï¼‰
   },
   
   // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆè²¼ã‚Šä»˜ã‘UIè¨­å®š
   screenshotPaste: {
       showSuccessAnimation: true,     // æˆåŠŸæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º
       highlightDropZone: true,        // ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤º
       autoFocusTextarea: true,        // è²¼ã‚Šä»˜ã‘å¾Œã«è³ªå•ã‚¨ãƒªã‚¢ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
       showPreviewThumbnail: true,     // ã‚µãƒ ãƒã‚¤ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
       enableKeyboardShortcuts: true   // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆæœ‰åŠ¹åŒ–
   }
};

// ===== è¨€èªè¨­å®š =====
// ğŸŒ ç¿»è¨³å¯¾å¿œè¨€èªã®å®šç¾©
window.SUPPORTED_LANGUAGES = {
   'en': {
       name: 'è‹±èª',
       flag: 'ğŸ‡ºğŸ‡¸',
       code: 'en'
   },
   'zh': {
       name: 'ä¸­å›½èª',
       flag: 'ğŸ‡¨ğŸ‡³',
       code: 'zh'
   },
   'ko': {
       name: 'éŸ“å›½èª',
       flag: 'ğŸ‡°ğŸ‡·',
       code: 'ko'
   },
   'ja': {
       name: 'æ—¥æœ¬èª',
       flag: 'ğŸ‡¯ğŸ‡µ',
       code: 'ja'
   }
};

// ===== ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿è¨­å®š =====
window.SAMPLE_RESPONSES = {
   translation: {
       'en': 'Hello! This is a sample AI translation. To use real translation, please set up your OpenAI API key in the settings.',
       'zh': 'ä½ å¥½ï¼è¿™æ˜¯ç¤ºä¾‹AIç¿»è¨³ã€‚è¦ä½¿ç”¨çœŸå®ç¿»è¨³ï¼Œè¯·åœ¨è®¾ç½®ä¸­é…ç½®æ‚¨çš„OpenAI APIå¯†é’¥ã€‚',
       'ko': 'ì•ˆë…•í•˜ì„¸ìš”! ì´ê²ƒì€ ìƒ˜í”Œ AI ë²ˆì—­ì…ë‹ˆë‹¤. ì‹¤ì œ ë²ˆì—­ì„ ì‚¬ìš©í•˜ë ¤ë©´ ì„¤ì •ì—ì„œ OpenAI API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.',
       'ja': 'ã“ã‚“ã«ã¡ã¯ï¼ã“ã‚Œã¯ã‚µãƒ³ãƒ—ãƒ«AIç¿»è¨³ã§ã™ã€‚å®Ÿéš›ã®ç¿»è¨³ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€è¨­å®šã§OpenAI APIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚'
   },
   
   transcript: {
       text: `ğŸ¤ éŸ³å£°æ–‡å­—èµ·ã“ã—ï¼ˆã‚µãƒ³ãƒ—ãƒ«çµæœï¼‰

ã€ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ãã€‘
[00:00] ã“ã‚“ã«ã¡ã¯ã€ä»Šæ—¥ã®ä¼šè­°ã‚’å§‹ã‚ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚
[00:05] ã¾ãšæœ€åˆã«ã€å‰å›ã®è­°äº‹éŒ²ã®ç¢ºèªã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚
[00:12] å£²ä¸Šã«ã¤ã„ã¦ã¯ã€å‰æœˆæ¯”ã§15ï¼…ã®å¢—åŠ ã¨ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
[00:20] æ¬¡ã«ã€æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦èª¬æ˜ã„ãŸã—ã¾ã™ã€‚

ã€è¦ç´„ã€‘
- ä¼šè­°é–‹å§‹ã®æŒ¨æ‹¶
- å‰å›è­°äº‹éŒ²ã®ç¢ºèªä¾é ¼
- å£²ä¸Šå ±å‘Šï¼ˆå‰æœˆæ¯”15%å¢—ï¼‰
- æ–°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èª¬æ˜äºˆå‘Š

ğŸ’¡ å®Ÿéš›ã®éŸ³å£°æ–‡å­—èµ·ã“ã—ã«ã¯ã€APIè¨­å®šã§OpenAIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚`
   },
   
   analysis: {
       error_analysis: `ğŸ” ç”»åƒè§£æçµæœï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰

**ğŸ¯ æ¤œå‡ºã•ã‚ŒãŸå•é¡Œ**
- ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰: TypeError: Cannot read property 'length' of undefined
- ç™ºç”Ÿç®‡æ‰€: script.js è¡Œ125
- ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—: JavaScriptå®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼

**ğŸ“‹ å•é¡Œã®è©³ç´°åˆ†æ**
1. **åŸå› **: å¤‰æ•°ãŒ undefined ã®çŠ¶æ…‹ã§ length ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **å½±éŸ¿ç¯„å›²**: ãƒšãƒ¼ã‚¸ã®ä¸€éƒ¨æ©Ÿèƒ½ãŒåœæ­¢
3. **ç·Šæ€¥åº¦**: ä¸­ç¨‹åº¦ï¼ˆæ©Ÿèƒ½ä¸å…¨ã ãŒå›é¿å¯èƒ½ï¼‰

**ğŸ› ï¸ è§£æ±ºç­–**
\`\`\`javascript
// ä¿®æ­£å‰ï¼ˆã‚¨ãƒ©ãƒ¼ã®åŸå› ï¼‰
if (data.length > 0) {
   // å‡¦ç†
}

// ä¿®æ­£å¾Œï¼ˆå®‰å…¨ãªæ›¸ãæ–¹ï¼‰
if (data && data.length > 0) {
   // å‡¦ç†
}
\`\`\`

**ğŸ“ äºˆé˜²ç­–**
- ãƒ‡ãƒ¼ã‚¿å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã‚’å¿…ãšå®Ÿè£…
- TypeScriptã®å°å…¥ã‚’æ¤œè¨
- ãƒ‡ãƒãƒƒã‚¬ãƒ¼ãƒ„ãƒ¼ãƒ«ã®æ´»ç”¨

ğŸ’¡ å®Ÿéš›ã®ç”»åƒè§£æã«ã¯ã€APIè¨­å®šã§OpenAIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚`,

       office_analysis: `ğŸ’¼ Officeç”»é¢è§£æçµæœï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰

**ğŸ¯ ç”»é¢ã®å†…å®¹**
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³: Microsoft Excel
- ç”»é¢ã‚¿ã‚¤ãƒ—: ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãƒ»åˆ†æç”»é¢
- ç¾åœ¨ã®çŠ¶æ³: ã‚°ãƒ©ãƒ•ä½œæˆä¸­

**ğŸ“‹ æ¤œå‡ºã•ã‚ŒãŸæ“ä½œãƒ»å•é¡Œç‚¹**
1. **ãƒ‡ãƒ¼ã‚¿ç¯„å›²**: A1:E10ã®ç¯„å›²ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã™
2. **ã‚°ãƒ©ãƒ•ã‚¿ã‚¤ãƒ—**: æ£’ã‚°ãƒ©ãƒ•ãŒæŒ¿å…¥ã•ã‚Œã¦ã„ã¾ã™
3. **å¯èƒ½ãªæ”¹å–„**: ã‚¿ã‚¤ãƒˆãƒ«ã¨ãƒ©ãƒ™ãƒ«ã®è¿½åŠ ãŒå¿…è¦

**ğŸ› ï¸ æ¨å¥¨ã•ã‚Œã‚‹æ“ä½œæ‰‹é †**
1. **ã‚°ãƒ©ãƒ•ã‚¿ã‚¤ãƒˆãƒ«ã®è¿½åŠ **
  - ã‚°ãƒ©ãƒ•ã‚’é¸æŠ
  - ã€Œã‚°ãƒ©ãƒ•ãƒ„ãƒ¼ãƒ«ã€â†’ã€Œãƒ‡ã‚¶ã‚¤ãƒ³ã€â†’ã€Œã‚°ãƒ©ãƒ•è¦ç´ ã‚’è¿½åŠ ã€
  - ã€Œã‚°ãƒ©ãƒ•ã‚¿ã‚¤ãƒˆãƒ«ã€ã‚’é¸æŠ

2. **è»¸ãƒ©ãƒ™ãƒ«ã®è¨­å®š**
  - ã€Œã‚°ãƒ©ãƒ•è¦ç´ ã‚’è¿½åŠ ã€â†’ã€Œè»¸ãƒ©ãƒ™ãƒ«ã€
  - æ¨ªè»¸ãƒ»ç¸¦è»¸ãã‚Œãã‚Œã«é©åˆ‡ãªãƒ©ãƒ™ãƒ«ã‚’è¨­å®š

3. **ãƒ‡ãƒ¼ã‚¿ãƒ©ãƒ™ãƒ«ã®è¡¨ç¤º**
  - ã€Œã‚°ãƒ©ãƒ•è¦ç´ ã‚’è¿½åŠ ã€â†’ã€Œãƒ‡ãƒ¼ã‚¿ãƒ©ãƒ™ãƒ«ã€
  - å¿…è¦ã«å¿œã˜ã¦å€¤ã‚’è¡¨ç¤º

**ğŸ’¡ ä¾¿åˆ©ãªã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ**
- F11: ã‚°ãƒ©ãƒ•ã‚’åˆ¥ã‚·ãƒ¼ãƒˆã«ç§»å‹•
- Ctrl+1: é¸æŠè¦ç´ ã®æ›¸å¼è¨­å®š
- Alt+F1: æ¨™æº–ã‚°ãƒ©ãƒ•ã‚’æŒ¿å…¥

ğŸ’¡ å®Ÿéš›ã®ç”»é¢è§£æã«ã¯ã€APIè¨­å®šã§OpenAIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚`,

       ui_analysis: `ğŸ¨ UI/UXè§£æçµæœï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰

**ğŸ¯ ãƒ‡ã‚¶ã‚¤ãƒ³è©•ä¾¡**
- å…¨ä½“çš„ãªå°è±¡: ãƒ¢ãƒ€ãƒ³ã§ã‚¯ãƒªãƒ¼ãƒ³
- é…è‰²: ãƒ–ãƒ«ãƒ¼ç³»çµ±ã§çµ±ä¸€æ„Ÿã‚ã‚Š
- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ: ã‚°ãƒªãƒƒãƒ‰ãƒ™ãƒ¼ã‚¹ã§æ•´ç†ã•ã‚Œã¦ã„ã‚‹

**âš ï¸ æ”¹å–„ç‚¹**
1. **ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ**: ä¸€éƒ¨ãƒ†ã‚­ã‚¹ãƒˆãŒèƒŒæ™¯ã«å¯¾ã—ã¦è–„ã„
2. **ãƒœã‚¿ãƒ³é…ç½®**: CTAãƒœã‚¿ãƒ³ãŒã‚„ã‚„å°ã•ã„
3. **ä½™ç™½**: ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤ºã§è©°ã¾ã£ã¦è¦‹ãˆã‚‹

**âœ¨ æ”¹å–„ææ¡ˆ**
- ãƒœã‚¿ãƒ³ã‚µã‚¤ã‚ºã‚’1.5å€ã«æ‹¡å¤§
- ãƒ†ã‚­ã‚¹ãƒˆã‚«ãƒ©ãƒ¼ã‚’#333ã«å¤‰æ›´
- ãƒ¢ãƒã‚¤ãƒ«æ™‚ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’20pxã«èª¿æ•´

**ğŸ“Š ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢**
- ç¾åœ¨: 78/100
- æ”¹å–„å¾Œï¼ˆäºˆæ¸¬ï¼‰: 92/100

ğŸ’¡ å®Ÿéš›ã®UI/UXè§£æã«ã¯ã€APIè¨­å®šã§OpenAIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚`
   },
   
   office: `ğŸ’¼ Officeæ“ä½œã®ãƒ’ãƒ³ãƒˆ

**ğŸ’¡ ä¸€èˆ¬çš„ãªè§£æ±ºæ–¹æ³•:**
- F1ã‚­ãƒ¼ã§ãƒ˜ãƒ«ãƒ—ã‚’é–‹ã
- ãƒªãƒœãƒ³ã®æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã«æ©Ÿèƒ½åã‚’å…¥åŠ›
- å³ã‚¯ãƒªãƒƒã‚¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ç¢ºèª
- Ctrl+Zã§æ“ä½œã‚’å…ƒã«æˆ»ã™

**ğŸ“š ã‚ˆã‚Šè©³ã—ã„å›ç­”ã‚’å¾—ã‚‹ã«ã¯:**
APIè¨­å®šã§ OpenAI ã‚­ãƒ¼ã‚’è¨­å®šã™ã‚‹ã¨ã€å…·ä½“çš„ã§è©³ç´°ãªè§£æ±ºç­–ã‚’æä¾›ã§ãã¾ã™ã€‚
ã¾ãŸã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’è²¼ã‚Šä»˜ã‘ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šæ­£ç¢ºãªå›ç­”ã‚’å¾—ã‚‰ã‚Œã¾ã™ã€‚`
};

// ===== ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¨­å®š =====
window.ERROR_MESSAGES = {
   noApiKey: 'APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚è¨­å®šç”»é¢ã‹ã‚‰APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
   invalidApiKey: 'ç„¡åŠ¹ãªAPIã‚­ãƒ¼ã§ã™ã€‚æ­£ã—ã„APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
   networkError: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚',
   rateLimitError: 'APIåˆ©ç”¨åˆ¶é™ã«é”ã—ã¦ã„ã¾ã™ã€‚ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚',
   emptyInput: 'å…¥åŠ›å†…å®¹ãŒç©ºã§ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
   processingError: 'å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚',
   
   // éŸ³å£°å‡¦ç†ç”¨ã‚¨ãƒ©ãƒ¼
   noAudioFile: 'éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚',
   unsupportedFormat: 'ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„éŸ³å£°å½¢å¼ã§ã™ã€‚MP3ã€WAVã€M4Aã€WEBMã€OGGã€FLACãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚',
   fileTooLarge: 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã™ãã¾ã™ã€‚25MBä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚',
   audioProcessingError: 'éŸ³å£°å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã‚’ç¢ºèªã—ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚',
   
   // ç”»åƒè§£æç”¨ã‚¨ãƒ©ãƒ¼
   noImageFile: 'ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚',
   unsupportedImageFormat: 'ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ç”»åƒå½¢å¼ã§ã™ã€‚JPEGã€PNGã€WEBPã€GIFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚',
   imageTooLarge: 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã™ãã¾ã™ã€‚20MBä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚',
   imageProcessingError: 'ç”»åƒè§£æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã‚’ç¢ºèªã—ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚',
   
   // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆé–¢é€£ã‚¨ãƒ©ãƒ¼
   clipboardAccessDenied: 'ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚',
   noImageInClipboard: 'ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ç”»åƒãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚',
   clipboardReadError: 'ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®èª­ã¿å–ã‚Šã«å¤±æ•—ã—ã¾ã—ãŸã€‚',
   pasteNotSupported: 'ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯è²¼ã‚Šä»˜ã‘æ©Ÿèƒ½ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚'
};

// ===== æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¨­å®š =====
window.SUCCESS_MESSAGES = {
   apiKeySaved: 'ğŸ‰ APIã‚­ãƒ¼ãŒä¿å­˜ã•ã‚Œã¾ã—ãŸï¼ã™ã¹ã¦ã®æ©Ÿèƒ½ãŒåˆ©ç”¨å¯èƒ½ã§ã™',
   translationComplete: 'ç¿»è¨³ãŒå®Œäº†ã—ã¾ã—ãŸ',
   correctionComplete: 'æ ¡æ­£ãŒå®Œäº†ã—ã¾ã—ãŸ',
   summaryComplete: 'è¦ç´„ãŒå®Œäº†ã—ã¾ã—ãŸ',
   officeHelpComplete: 'è§£æ±ºç­–ã‚’è¡¨ç¤ºã—ã¾ã—ãŸ',
   copySuccess: 'ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ',
   appStarted: 'ğŸ¤– HishoAI Enhanced ãŒèµ·å‹•ã—ã¾ã—ãŸï¼',
   
   // éŸ³å£°å‡¦ç†ç”¨æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
   transcriptComplete: 'éŸ³å£°æ–‡å­—èµ·ã“ã—ãŒå®Œäº†ã—ã¾ã—ãŸ',
   audioUploaded: 'éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸ',
   
   // ç”»åƒè§£æç”¨æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
   imageAnalysisComplete: 'ç”»åƒè§£æãŒå®Œäº†ã—ã¾ã—ãŸ',
   imageUploaded: 'ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸ',
   
   // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆé–¢é€£æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
   screenshotPasted: 'ğŸ“· ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãŒè²¼ã‚Šä»˜ã‘ã‚‰ã‚Œã¾ã—ãŸ',
   
   // ãã®ä»–
   historySaved: 'å±¥æ­´ã«ä¿å­˜ã—ã¾ã—ãŸ',
   exportComplete: 'ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ'
};

// ===== APIé€šä¿¡è¨­å®š =====
window.API_CONFIG = {
   baseUrl: 'https://api.openai.com/v1',
   timeout: 30000,  // 30ç§’ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
   maxRetries: 3    // æœ€å¤§3å›ã¾ã§å†è©¦è¡Œ
};

// ===== ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š =====
window.SECURITY_CONFIG = {
   sanitizeInput: true,        // å…¥åŠ›ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚º
   maxInputLength: 10000,      // æœ€å¤§å…¥åŠ›æ–‡å­—æ•°
   allowedFileTypes: [         // è¨±å¯ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—
       ...window.AUDIO_SETTINGS.supportedFormats,
       ...window.IMAGE_SETTINGS.supportedFormats,
       ...window.SCREENSHOT_SETTINGS.supportedClipboardTypes
   ],
   apiKeyMasking: true,        // APIã‚­ãƒ¼ã®ãƒã‚¹ã‚¯è¡¨ç¤º
   secureStorage: true         // å®‰å…¨ãªã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨
};

// ===== è¨­å®šã®æ¤œè¨¼ =====
function validateConfig() {
   const errors = [];
   const warnings = [];
   
   console.log('ğŸ” è¨­å®šã‚’æ¤œè¨¼ä¸­...');
   
   // ãƒ¢ãƒ‡ãƒ«åã®æ¤œè¨¼
   if (!window.DEFAULT_MODEL || typeof window.DEFAULT_MODEL !== 'string') {
       errors.push('Invalid model configuration');
   }
   
   // æ¸©åº¦è¨­å®šã®æ¤œè¨¼
   Object.entries(window.AI_TEMPERATURE).forEach(([key, value]) => {
       if (value < 0 || value > 1) {
           errors.push(`Invalid temperature for ${key}: ${value}`);
       }
   });
   
   // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™ã®æ¤œè¨¼
   if (window.AUDIO_SETTINGS.maxFileSize <= 0 || window.AUDIO_SETTINGS.maxFileSize > 50) {
       warnings.push('Audio file size limit seems unusual');
   }
   
   if (window.IMAGE_SETTINGS.maxFileSize <= 0 || window.IMAGE_SETTINGS.maxFileSize > 50) {
       warnings.push('Image file size limit seems unusual');
   }
   
   // Clipboard API ã®åˆ©ç”¨å¯èƒ½æ€§ãƒã‚§ãƒƒã‚¯
   if (!navigator.clipboard) {
       warnings.push('Clipboard API is not available - screenshot paste may not work');
   }
   
   // çµæœã®å‡ºåŠ›
   if (errors.length > 0) {
       console.error('âŒ Config validation errors:', errors);
       return false;
   }
   
   if (warnings.length > 0) {
       console.warn('âš ï¸ Config validation warnings:', warnings);
   }
   
   console.log('âœ… Config validation passed');
   return true;
}

// ===== åˆæœŸåŒ–å®Ÿè¡Œ =====
(function initialize() {
   console.log(`ğŸš€ HishoAI Enhanced Config loaded`);
   console.log(`ğŸ“Š Model: ${window.DEFAULT_MODEL}`);
   console.log(`ğŸ”‘ API Key: ${window.OPENAI_API_KEY ? 'è¨­å®šæ¸ˆã¿' : 'æœªè¨­å®š'}`);
   console.log(`ğŸ“± Version: 4.0 Completeï¼ˆè²·ã„åˆ‡ã‚Šå®Œå…¨ç‰ˆï¼‰`);
   console.log(`ğŸŒ Translation Max Tokens: ${window.MAX_TOKENS.translation} (æ¥­ç•Œæœ€å¤§ç´š)`);
   
   // è¨­å®šã®æ¤œè¨¼å®Ÿè¡Œ
   const configValid = validateConfig();
   
   // ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã€è©³ç´°æƒ…å ±ã‚’è¡¨ç¤º
   if (window.UI_SETTINGS.debugMode) {
       console.log('ğŸ” è¨­å®šè©³ç´°:', {
           temperatures: window.AI_TEMPERATURE,
           maxTokens: window.MAX_TOKENS,
           audioSettings: window.AUDIO_SETTINGS,
           imageSettings: window.IMAGE_SETTINGS,
           screenshotSettings: window.SCREENSHOT_SETTINGS,
           uiSettings: window.UI_SETTINGS,
           supportedLanguages: window.SUPPORTED_LANGUAGES
       });
   }
   
   console.log('âœ… è¨­å®šã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¾ã—ãŸï¼ˆæ—¢å­˜æ©Ÿèƒ½å®Œå…¨ä¿æŒãƒ»10000ãƒˆãƒ¼ã‚¯ãƒ³å¯¾å¿œç‰ˆï¼‰');
})();
